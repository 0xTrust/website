<!DOCTYPE html>
<html lang="en-US" class="has-navbar-fixed-top">

<head>
    <meta name="generator" content="Hugo 0.55.0-DEV" />
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>HTTP头字段为何要弃用X前缀 | Tony Xu 博客</title>

     
      
    
    
    
    
    

  <meta name="author" content="徐毅涵">

 
    <meta property="og:title" content="HTTP头字段为何要弃用X前缀" />
<meta property="og:description" content=" 2012年6月，互联网工程任务小组(IETF)发布了新的征求意见稿(RFC-6648)，要求自定义HTTP头字段应放弃使用X-前缀。由于我所在的LinkedIn也在使用这类自定义头字段，因此特意阅读了这份征求意见稿，给大家解释以下为什么我们需要弃用它。
X前缀诞生背景 HTTP头的作用是为了让客户端和服务器传送信息时能够附加一些额外信息。
HTTP Header（HTTP头) 有一些标准字段，如:
 Authorization: 常用于传OAuth的Access Token或其他认证信息, 如Authorization: Bearer ABCDEFG
 Content-Type: 常用于表明Request Body 请求体的多媒体类型, 如application/x-www-form-urlencoded或application/json)
 User-Agent: 浏览器标识符, 如Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.84 Safari/537.36
  如果想在HTTP头里添加自定义的字段，为了和标准字段区分，之前是建议加上X-前缀的(X代表Extension)。这个建议是在1982年为Email标准提出(参考RFC-822)，行之有效了几十年。
X前缀的使用 在众多非标准HTTP头中，有一些变得越来越普遍，如:
 X-Forwarded-For: 标记通过代理访问服务器的原始客户端IP地址
 X-Forwarded-Host: 标记通过代理访问服务器的原始客户端Host名
 X-Forwarded-Proto: 标记原始客户端通过代理访问服务器时用的协议
 X-Powered-By: 标记框架、技术、环境等
  X前缀的问题 这些带X-前缀的HTTP头变得越来越普遍后，当需要把他们标准化时，如何处理这个X-前缀就变得比较棘手。按理说标准化HTTP头后应该拿掉X-前缀，但是拿掉后显然会对一些依赖原来HTTP头的程序造成影响。为了保证兼容性，我们无法彻底拿掉X-前缀。总结来说，使用X-前缀本意是区分标准化和自定义HTTP头，但是却越来越无法达到这一目标。
解决方案  不再建议新自定义HTTP头采用X-前缀，X-前缀也不再作为标准与非标准的标记
 如果新的自定义HTTP头有可能被标准化，则选取当前未被占用的有意义的HTTP头字段名
 如果新的自定义HTTP头不可能被标准化，完全是私有HTTP头，则建议包含组织名(如反域名com.example.foo)
 已有的自定义HTTP头，保留使用或者放弃使用都可，不做推荐
 是否包含X-前缀不能作为HTTP头是否安全的判断因素
  " />
<meta property="og:type" content="article" />
<meta property="og:url" content="/zh/posts/2018/http-deprecate-x-prefix/" />
<meta property="article:published_time" content="2018-08-01T00:00:00&#43;00:00"/>
<meta property="article:modified_time" content="2018-08-01T00:00:00&#43;00:00"/><meta property="og:site_name" content="Tony Xu 博客" />
 
    



 
    
     
    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-577792-7', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>
 
    
    
    <link rel="canonical" href="/zh/posts/2018/http-deprecate-x-prefix/">   <link rel="shortcut icon" type="image/png" href="/profile-pic.png">


    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"> 
    <link rel="stylesheet" href="/css/bulma.css"> 
    <script type="text/javascript" src="/js/bulma.js"></script>
  </head>


<body>
    <header> <nav class="navbar is-fixed-top">
  <div class="container">
    <div class="navbar-brand">
      <a class="navbar-item" href="/zh">
        <img src="/profile-pic.png" alt="logo">
      </a>
      <a class="navbar-item" href="/zh">
        Tony Xu 博客
      </a>
      <a role="button" class="navbar-burger" data-target="navMenu" aria-label="menu" aria-expanded="false">
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
      </a>
    </div>

    <div class="navbar-menu" id="navMenu">

      
      
      <div class="navbar-end">
        
        <a class="navbar-item" target="blank" href="https://github.com/tonyxu-io">
          <span class="icon">
            <i class="fa fa-github"></i>
          </span>
        </a>
        

        
        <a class="navbar-item" target="blank" href="https://www.linkedin.com/in/tonyxu93">
          <span class="icon">
            <i class="fa fa-linkedin"></i>
          </span>
        </a>
        
        <div class="navbar-item">
          
          
          <a itemprop="url" class="navbar-item "
            href="/zh/about"><span itemprop="name">关于</span></a>
          
          <a itemprop="url" class="navbar-item "
            href="/zh/friends/"><span itemprop="name">友情链接</span></a>
          
          <a itemprop="url" class="navbar-item  is-active"
            href="/zh/posts/"><span itemprop="name">文章</span></a>
          
        </div>
        
        <div class="navbar-item">
          <div class="field">
            <div class="control has-icons-left">
              <div class="select is-rounded  is-small">
                <select size="1" name="links" onchange="window.location.href=this.value;">
                  <option selected disabled>语言</option>
                  
                  <option value="/posts/2018/http-deprecate-x-prefix/">English</option>
                  
                </select>
              </div>
              <div class="icon is-small is-left">
                <i class="fa fa-globe"></i>
              </div>
            </div>
          </div>
        </div>
        
      </div>
    </div>
  </div>

</nav> </header>
    <main>

<div class="section">
  <div class="container" itemscope itemtype="http://schema.org/BlogPosting">
    
<meta itemprop="name" content="HTTP头字段为何要弃用X前缀">
<meta itemprop="description" content=" 2012年6月，互联网工程任务小组(IETF)发布了新的征求意见稿(RFC-6648)，要求自定义HTTP头字段应放弃使用X-前缀。由于我所在的LinkedIn也在使用这类自定义头字段，因此特意阅读了这份征求意见稿，给大家解释以下为什么我们需要弃用它。
X前缀诞生背景 HTTP头的作用是为了让客户端和服务器传送信息时能够附加一些额外信息。
HTTP Header（HTTP头) 有一些标准字段，如:
 Authorization: 常用于传OAuth的Access Token或其他认证信息, 如Authorization: Bearer ABCDEFG
 Content-Type: 常用于表明Request Body 请求体的多媒体类型, 如application/x-www-form-urlencoded或application/json)
 User-Agent: 浏览器标识符, 如Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.84 Safari/537.36
  如果想在HTTP头里添加自定义的字段，为了和标准字段区分，之前是建议加上X-前缀的(X代表Extension)。这个建议是在1982年为Email标准提出(参考RFC-822)，行之有效了几十年。
X前缀的使用 在众多非标准HTTP头中，有一些变得越来越普遍，如:
 X-Forwarded-For: 标记通过代理访问服务器的原始客户端IP地址
 X-Forwarded-Host: 标记通过代理访问服务器的原始客户端Host名
 X-Forwarded-Proto: 标记原始客户端通过代理访问服务器时用的协议
 X-Powered-By: 标记框架、技术、环境等
  X前缀的问题 这些带X-前缀的HTTP头变得越来越普遍后，当需要把他们标准化时，如何处理这个X-前缀就变得比较棘手。按理说标准化HTTP头后应该拿掉X-前缀，但是拿掉后显然会对一些依赖原来HTTP头的程序造成影响。为了保证兼容性，我们无法彻底拿掉X-前缀。总结来说，使用X-前缀本意是区分标准化和自定义HTTP头，但是却越来越无法达到这一目标。
解决方案  不再建议新自定义HTTP头采用X-前缀，X-前缀也不再作为标准与非标准的标记
 如果新的自定义HTTP头有可能被标准化，则选取当前未被占用的有意义的HTTP头字段名
 如果新的自定义HTTP头不可能被标准化，完全是私有HTTP头，则建议包含组织名(如反域名com.example.foo)
 已有的自定义HTTP头，保留使用或者放弃使用都可，不做推荐
 是否包含X-前缀不能作为HTTP头是否安全的判断因素
  ">


<meta itemprop="datePublished" content="2018-08-01T00:00:00&#43;00:00" />
<meta itemprop="dateModified" content="2018-08-01T00:00:00&#43;00:00" />
<meta itemprop="wordCount" content="51">



<meta itemprop="keywords" content="" />

    <div class="columns">
      <div class="column is-8 is-offset-2">
        <p class="title">HTTP头字段为何要弃用X前缀</p>
        <p class="text">
  
  <span>2018 年 8 月 1 日</span>
  
</p>
        <hr />
        <div class="content">
          

<p>2012年6月，互联网工程任务小组(IETF)发布了新的征求意见稿(<a href="https://tools.ietf.org/html/rfc6648">RFC-6648</a>)，要求自定义HTTP头字段应放弃使用<code>X-</code>前缀。由于我所在的LinkedIn也在使用这类自定义头字段，因此特意阅读了这份征求意见稿，给大家解释以下为什么我们需要弃用它。</p>

<h2 id="x前缀诞生背景">X前缀诞生背景</h2>

<p>HTTP头的作用是为了让客户端和服务器传送信息时能够附加一些额外信息。</p>

<p>HTTP Header（HTTP头) 有一些标准字段，如:</p>

<ul>
<li><code>Authorization</code>: 常用于传OAuth的Access Token或其他认证信息, 如<code>Authorization: Bearer ABCDEFG</code><br /></li>
<li><code>Content-Type</code>: 常用于表明Request Body 请求体的多媒体类型, 如<code>application/x-www-form-urlencoded</code>或<code>application/json</code>)<br /></li>
<li><code>User-Agent</code>: 浏览器标识符, 如<code>Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.84 Safari/537.36</code><br />
<br /></li>
</ul>

<p>如果想在HTTP头里添加自定义的字段，为了和标准字段区分，之前是建议加上<code>X-</code>前缀的(<code>X</code>代表Extension)。这个建议是在1982年为Email标准提出(参考<a href="https://tools.ietf.org/html/rfc822">RFC-822</a>)，行之有效了几十年。</p>

<h2 id="x前缀的使用">X前缀的使用</h2>

<p>在众多非标准HTTP头中，有一些变得越来越普遍，如:</p>

<ul>
<li><code>X-Forwarded-For</code>: 标记通过代理访问服务器的原始客户端IP地址<br /></li>
<li><code>X-Forwarded-Host</code>: 标记通过代理访问服务器的原始客户端Host名<br /></li>
<li><code>X-Forwarded-Proto</code>: 标记原始客户端通过代理访问服务器时用的协议<br /></li>
<li><code>X-Powered-By</code>: 标记框架、技术、环境等<br />
<br /></li>
</ul>

<h2 id="x前缀的问题">X前缀的问题</h2>

<p>这些带<code>X-</code>前缀的HTTP头变得越来越普遍后，当需要把他们标准化时，如何处理这个<code>X-</code>前缀就变得比较棘手。按理说标准化HTTP头后应该拿掉<code>X-</code>前缀，但是拿掉后显然会对一些依赖原来HTTP头的程序造成影响。为了保证兼容性，我们无法彻底拿掉<code>X-</code>前缀。总结来说，使用<code>X-</code>前缀本意是区分标准化和自定义HTTP头，但是却越来越无法达到这一目标。</p>

<h2 id="解决方案">解决方案</h2>

<ol>
<li>不再建议新自定义HTTP头采用<code>X-</code>前缀，<code>X-</code>前缀也不再作为标准与非标准的标记<br /></li>
<li>如果新的自定义HTTP头有可能被标准化，则选取当前未被占用的有意义的HTTP头字段名<br /></li>
<li>如果新的自定义HTTP头不可能被标准化，完全是私有HTTP头，则建议包含组织名(如反域名<code>com.example.foo</code>)<br /></li>
<li>已有的自定义HTTP头，保留使用或者放弃使用都可，不做推荐<br /></li>
<li>是否包含<code>X-</code>前缀不能作为HTTP头是否安全的判断因素<br /></li>
</ol>

        </div>
        
        <article>
          <div id="disqus_thread"></div>
<script type="text/javascript">

(function() {
    
    
    if (window.location.hostname == "localhost")
        return;

    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    var disqus_shortname = 'tonyxu-io';
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com/" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
        </article>
        
      </div>
    </div>
  </div>
</div>
</main>
    <footer>
<footer class="footer">
  <div class="container">
    <div class="content has-text-centered">
      <p>
        © 2018-2019 Tony Xu 徐毅涵
      </p>
    </div>
  </div>
</footer>
</footer>

</body>

</html>